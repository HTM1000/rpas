# Coordenadas Exatas dos Campos Oracle

## ğŸ“ Mapeamento Visual Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FormulÃ¡rio Oracle - TransferÃªncia de SubinventÃ¡rio                         â”‚
â”‚  Linha Y=155 a Y=177 (Altura: 22 pixels)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Linha Horizontal Ãšnica (Y=155 â†’ Y=177):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  67              208       316       422       530       639       737
  â†“               â†“         â†“         â†“         â†“         â†“         â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Item      â”‚ â”‚Sub.Oriâ”‚ â”‚End.Oriâ”‚ â”‚ParaSubâ”‚ â”‚ParaLocâ”‚ â”‚ Qtd  â”‚ â”‚  Ref  â”‚
  â”‚             â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚ â”‚      â”‚ â”‚       â”‚
  â”‚  118px      â”‚ â”‚ 101px â”‚ â”‚ 101px â”‚ â”‚ 103px â”‚ â”‚ 100px â”‚ â”‚ 89px â”‚ â”‚ 100px â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
  185             309       417       525       630       728      837


Legenda:
â”€â”€â”€â”€â”€â”€â”€â”€â”€
Item      = campo_item       [67,  155, 118, 22]
Sub.Ori   = campo_sub_o      [208, 155, 101, 22]  â† SubinventÃ¡rio Origem
End.Ori   = campo_end_o      [316, 155, 101, 22]  â† EndereÃ§o Origem
ParaSub   = campo_sub_d      [422, 155, 103, 22]  â† Para SubinventÃ¡rio (Destino)
ParaLoc   = campo_end_d      [530, 155, 100, 22]  â† Para LocalizaÃ§Ã£o (Destino)
Qtd       = campo_quantidade [639, 155,  89, 22]
Ref       = campo_referencia [737, 155, 100, 22]
```

---

## ğŸ“Š Tabela Detalhada de Coordenadas

### Formato: `[X_inicial, Y_inicial, Largura, Altura]`

| Campo                  | Nome CÃ³digo      | X   | Y   | Largura | Altura | X_final | Y_final |
|------------------------|------------------|-----|-----|---------|--------|---------|---------|
| **Item**               | `campo_item`     | 67  | 155 | 118     | 22     | 185     | 177     |
| **Subinvent. Origem**  | `campo_sub_o`    | 208 | 155 | 101     | 22     | 309     | 177     |
| **EndereÃ§o Origem**    | `campo_end_o`    | 316 | 155 | 101     | 22     | 417     | 177     |
| **Para Sub (Destino)** | `campo_sub_d`    | 422 | 155 | 103     | 22     | 525     | 177     |
| **Para Loc (Destino)** | `campo_end_d`    | 530 | 155 | 100     | 22     | 630     | 177     |
| **Quantidade**         | `campo_quantidade` | 639 | 155 | 89    | 22     | 728     | 177     |
| **ReferÃªncia**         | `campo_referencia` | 737 | 155 | 100   | 22     | 837     | 177     |

---

## ğŸ¯ Pixels Centrais (para Clipboard - Ctrl+A+Ctrl+C)

Para clicar no **centro** de cada campo ao usar validaÃ§Ã£o por clipboard:

```python
# Formato: (X_centro, Y_centro) = (X + Largura/2, Y + Altura/2)

campo_item_centro       = (126, 166)  # (67  + 118/2, 155 + 22/2)
campo_sub_o_centro      = (258, 166)  # (208 + 101/2, 155 + 22/2)
campo_end_o_centro      = (366, 166)  # (316 + 101/2, 155 + 22/2)
campo_sub_d_centro      = (473, 166)  # (422 + 103/2, 155 + 22/2)
campo_end_d_centro      = (580, 166)  # (530 + 100/2, 155 + 22/2)
campo_quantidade_centro = (683, 166)  # (639 +  89/2, 155 + 22/2)
campo_referencia_centro = (787, 166)  # (737 + 100/2, 155 + 22/2)
```

---

## ğŸ“‹ JSON para config.json

```json
"campos_oracle_validacao": {
  "descricao": "Coordenadas completas dos campos para validaÃ§Ã£o hÃ­brida (x, y, largura, altura)",
  "observacao": "Todos os campos: Y=155, Altura=22 (Y_final=177)",
  "campo_item":       [67,  155, 118, 22],
  "campo_quantidade": [639, 155,  89, 22],
  "campo_referencia": [737, 155, 100, 22],
  "campo_sub_o":      [208, 155, 101, 22],
  "campo_end_o":      [316, 155, 101, 22],
  "campo_sub_d":      [422, 155, 103, 22],
  "campo_end_d":      [530, 155, 100, 22]
}
```

---

## ğŸ” ValidaÃ§Ã£o de Campos por Tipo de ReferÃªncia

### ReferÃªncia MOV / Outros (Origem)
Valida campos de **ORIGEM**:
- âœ… Item (67, 155, 118, 22)
- âœ… Quantidade (639, 155, 89, 22)
- âœ… ReferÃªncia (737, 155, 100, 22)
- âœ… **Subinvent. Origem** (208, 155, 101, 22)
- âœ… **EndereÃ§o Origem** (316, 155, 101, 22)

### ReferÃªncia COD (Destino)
Valida campos de **DESTINO**:
- âœ… Item (67, 155, 118, 22)
- âœ… Quantidade (639, 155, 89, 22)
- âœ… ReferÃªncia (737, 155, 100, 22)
- âœ… **Para Sub** (422, 155, 103, 22)
- âœ… **Para Loc** (530, 155, 100, 22)

---

## ğŸ§® CÃ¡lculos de ReferÃªncia

### Ãreas dos Campos (em pixelsÂ²)

| Campo              | Largura | Altura | Ãrea (pxÂ²) | % da linha* |
|--------------------|---------|--------|------------|-------------|
| Item               | 118     | 22     | 2.596      | 15.3%       |
| Subinvent. Origem  | 101     | 22     | 2.222      | 13.1%       |
| EndereÃ§o Origem    | 101     | 22     | 2.222      | 13.1%       |
| Para Sub           | 103     | 22     | 2.266      | 13.4%       |
| Para Loc           | 100     | 22     | 2.200      | 13.0%       |
| Quantidade         | 89      | 22     | 1.958      | 11.6%       |
| ReferÃªncia         | 100     | 22     | 2.200      | 13.0%       |

*% considerando largura total de 770px (67 a 837)

### EspaÃ§amentos entre Campos

| Entre campos                      | Pixels | ObservaÃ§Ã£o           |
|-----------------------------------|--------|----------------------|
| Item â†’ Subinv. Origem             | 23     | (208 - 185)          |
| Subinv. Origem â†’ EndereÃ§o Origem  | 7      | (316 - 309)          |
| EndereÃ§o Origem â†’ Para Sub        | 5      | (422 - 417)          |
| Para Sub â†’ Para Loc               | 5      | (530 - 525)          |
| Para Loc â†’ Quantidade             | 9      | (639 - 630)          |
| Quantidade â†’ ReferÃªncia           | 9      | (737 - 728)          |

---

## ğŸ“¸ Como Capturar Coordenadas

Se precisar recapturar as coordenadas:

```python
import pyautogui
import time
from PIL import ImageGrab

# 1. Capturar coordenadas manualmente
print("Posicione o mouse no CANTO SUPERIOR ESQUERDO do campo em 3s...")
time.sleep(3)
x1, y1 = pyautogui.position()
print(f"Canto superior esquerdo: X={x1}, Y={y1}")

print("Posicione o mouse no CANTO INFERIOR DIREITO do campo em 3s...")
time.sleep(3)
x2, y2 = pyautogui.position()
print(f"Canto inferior direito: X={x2}, Y={y2}")

largura = x2 - x1
altura = y2 - y1

print(f"\nâœ… Coordenadas do campo:")
print(f"   [{x1}, {y1}, {largura}, {altura}]")
print(f"   X: {x1} â†’ {x2} (largura: {largura}px)")
print(f"   Y: {y1} â†’ {y2} (altura: {altura}px)")

# 2. Capturar screenshot do campo
img = ImageGrab.grab(bbox=(x1, y1, x2, y2))
img.save(f"campo_{x1}_{y1}.png")
print(f"   Screenshot salvo: campo_{x1}_{y1}.png")
```

---

## âš™ï¸ Uso no CÃ³digo

### No validador_hibrido.py

```python
# FunÃ§Ã£o principal
validar_campo_oracle_hibrido(
    x=67,          # X inicial
    y=155,         # Y inicial
    largura=118,   # Largura
    altura=22,     # Altura
    valor_esperado="E2029B",
    nome_campo="Item"
)
```

### No main_ciclo.py

```python
# Carregar do config.json
coords_validacao = {
    "campo_item": (67, 155, 118, 22),
    "campo_quantidade": (639, 155, 89, 22),
    # ... outros campos
}

# Validar todos os campos
validar_campos_oracle_completo(
    coords_validacao,
    item, quantidade, referencia,
    sub_o, end_o, sub_d, end_d
)
```

---

## ğŸ¨ Diagrama ASCII Detalhado

```
Pixel X:  0    67   185 208 309 316 417 422 525 530 630 639 728 737 837
          |     |    |   |   |   |   |   |   |   |   |   |   |   |   |
Y=155 â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”€
          â”‚     â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚
          â”‚     â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚
          â”‚     â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚   â”‚â–ˆâ–ˆâ–ˆâ”‚
Y=177 â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”´â”€â”€â”€â”¼â”€â”€â”€â”€
          |     |    |   |   |   |   |   |   |   |   |   |   |   |   |

          Item=118px  101px 101px 103px 100px  89px 100px
```

---

## ğŸ“ Notas Importantes

1. **Todos os campos estÃ£o na mesma linha horizontal**
   - Y inicial: **155**
   - Y final: **177**
   - Altura: **22 pixels**

2. **NÃ£o hÃ¡ sobreposiÃ§Ã£o de campos**
   - Cada campo tem seu espaÃ§o exclusivo
   - EspaÃ§amentos entre campos variam de 5 a 23 pixels

3. **Ordem da esquerda para direita:**
   1. Item (67-185)
   2. Subinvent. Origem (208-309)
   3. EndereÃ§o Origem (316-417)
   4. Para Sub (422-525)
   5. Para Loc (530-630)
   6. Quantidade (639-728)
   7. ReferÃªncia (737-837)

4. **ResoluÃ§Ã£o testada:**
   - Essas coordenadas foram medidas na resoluÃ§Ã£o especÃ­fica do Oracle
   - Se mudar a resoluÃ§Ã£o ou scaling do Windows, recapture as coordenadas

---

## âœ… VerificaÃ§Ã£o RÃ¡pida

Execute este cÃ³digo para verificar se as coordenadas estÃ£o corretas:

```python
from validador_hibrido import validar_campo_preenchido

# Testar campo Item
preenchido, percentual, detalhes = validar_campo_preenchido(67, 155, 118, 22)
print(f"Campo Item preenchido: {preenchido} ({percentual:.2%})")

# Testar campo Quantidade
preenchido, percentual, detalhes = validar_campo_preenchido(639, 155, 89, 22)
print(f"Campo Quantidade preenchido: {preenchido} ({percentual:.2%})")
```

Se retornar percentuais entre 2% e 20%, as coordenadas estÃ£o corretas!

---

**Ãšltima atualizaÃ§Ã£o:** 2025-10-24
**Validado por:** UsuÃ¡rio
**Status:** âœ… Coordenadas confirmadas e testadas
